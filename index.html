<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex, noarchive, nosnippet, follow">
    <title>PPM Visualization</title>
    <style>

        html, body {
            background-color: #203040;
            font-family: Arial;
            width: 100%;
            margin: 0;
            padding: 0;
        }

        h1 {
            font-size: 38px;
            color: #FFA500;
            margin: 25px 0 25px 0;
        }

        p {
          color: #FFFFFF;
          max-width: 500px;
          margin: 0 auto;
          padding: 5px 15px 5px 15px;
        }

        canvas {
            background-color: #FFFFFF;
            border: 1px solid black;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        #container {
            max-width: 700px;
            margin: 0 auto;
            text-align: center;
            overflow: auto;
        }

        .input-labels {
          color: #FFFFFF;
        }

        #range-value {
          color: #FFFFFF
        }

        #number-of-dots {
          text-align: center;
          height: 30px;
          width: 100px;
        }

        #ppm-color {
          height: 30px;
          width: 80px;
        }

        .selector-div {
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .selector-element {
          display: inline-block;
          padding: 8px 10px;
        }

        @media only screen and (max-width: 500px) {
          h1 {
            font-size: 34px;
          }
        }

    </style>
</head>

<body onload="calculatePPM()" onresize="calculatePPM()">
    <div id="container">
        <h1>PPM Visualization</h1>

        <div class="selector-div">
          <div class="selector-element">
            <label for="number-of-dots" class="input-labels">Select PPM (1 - 8000)</label>
          </div>
          <div class="selector-element">
            <input type="number" id="number-of-dots" name="number-of-dots" min="1" max="8000" value="400" autofocus>
          </div>
        </div>

        <div class="selector-div">
          <div class="selector-element">
            <label for="ppm-color" class="input-labels">Select Color</label>
          </div>
          <div class="selector-element">
            <input type="color" id="ppm-color" name="ppm-color" value="#5B0000">
          </div>
        </div>


        <div class="selector-div">
          <div class="selector-element">
            <button type="button" id="runPPM">Display PPM</button>
          </div>
        </div>

        <canvas id="canvas"></canvas>

        <p>About PPM Visualization: The display area is based on a 100 particle
          width X 100 particle height X 100 particle depth to give a total volume
          of 1 million particles.</p>

        <br><br><br><br>
    </div>

    <script>


        // if enter key pressed run "calculatePPM" function
        let onEnter = document.getElementById('number-of-dots');
        onEnter.addEventListener('keyup', function(event) {
          if (event.keyCode === 13) {
            event.preventDefault();
            document.getElementById('runPPM').click();
          }
        });

        window.addEventListener("orientationchange", function() {
          calculatePPM();
        });

        function calculatePPM() {
          let canvas = document.getElementById('canvas');
          let ctx = canvas.getContext('2d');
          ctx.canvas.width = window.innerWidth > 700 ? 660 : window.innerWidth * .95;
          ctx.canvas.height = window.innerWidth > 700 ? 660 : window.innerWidth * .95;
          let width = canvas.width;
          let height = canvas.height;
          let dots = [];
          let numberOfDots = document.getElementById('number-of-dots').value;
          let dotColor = document.getElementById('ppm-color').value;
          let maxRange = document.getElementById('number-of-dots').max;
          let minRange = document.getElementById('number-of-dots').min;

          // class for creating each individual dot
          class Dot {
            constructor() {
              this.x = Math.random() * width;
              this.y = Math.random() * height;
              this.z = Math.random() * width;
              this.radius = width > 400 ? ((width / 100) / 2) - (this.z / width) : (width / 100) / 2;
            }

            draw() {
              ctx.globalAlpha = Math.abs(1 - (this.z / 1.9) / width);
              ctx.beginPath();
              ctx.arc(this.x, this.y, this.radius, 0, 360);
              ctx.fillStyle = dotColor;
              ctx.fill();
              ctx.closePath();
            }
          }

          if (numberOfDots >= minRange && numberOfDots <= maxRange) {
            // add all the dots to the dots array
            for (let i = 0; i < numberOfDots; i++) {
              dots.push(new Dot());
            }

            // clear all previous drawing from the canvas
            ctx.clearRect(0, 0, width, height);

            // Loop through the dots array and draw every dot
            for (var i = 0; i < dots.length; i++) {
              dots[i].draw();
            }
          } else { // if number of dots outside of range send an alert to the user
            alert('PPM out of range. Set range between 1 & ' + maxRange);
          }
        }

        // when 'Display PPM' button is clicked run calculatePPM function
        document.getElementById("runPPM").onclick = function() {
            calculatePPM();
        }

    </script>
</body>

</html>
